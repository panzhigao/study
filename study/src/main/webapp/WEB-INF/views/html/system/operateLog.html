<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>操作日志</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="keywords" content="$!{systemConfig.keywords}">
  <meta name="description" content="$!{systemConfig.description}">
  <link rel="icon" href="$!{rc.contextPath}/static/favicon.ico" type="image/x-icon" />
  <link rel="shortcut icon" href="$!{rc.contextPath}/static/favicon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="$!{rc.contextPath}/static/res/layui/css/layui.css">
  <link rel="stylesheet" href="$!{rc.contextPath}/static/res/css/global.css">
  <link rel="stylesheet" href="$!{rc.contextPath}/static/css/bootstrap.css" >
  <script type="text/javascript" src="$!{rc.contextPath}/static/js/jquery.js"></script>
  <script type="text/javascript" src="$!{rc.contextPath}/static/js/bootstrap.min.js"></script>
</head>
<body class="childrenBody">
  <div class="fly-panel fly-panel-user" pad20>
    <div class="layui-tab layui-tab-brief" lay-filter="user"> 
	    
      <div class="layui-form layui-form-pane">
          
          <div class="layui-inline">
	          <label class="layui-form-label">操作类型</label>
	          <div class="layui-input-inline" >
	               <select id="operateType" name="experience" lay-search>
	               		  <option value="">请选择</option>
	                      #foreach($item in $types)
	                      <option value="$item.code">$item.name</option>
	                      #end
	                </select>
	          </div>
          </div> 
      	   
      	  <div class="layui-inline"> 
      	  	  <label class="layui-form-label">用户名</label>
	          <div class="layui-input-inline" style="width: 190px;">
	          	<input placeholder="请输入用户名" class="layui-input" name="userName" id="userNameInput" autocomplete="off">
	          </div>
	          <div class="layui-inline">
	      	  	<button class="layui-btn" data-type="reload" id="search">搜索</button>	
	      	  </div>
      	  </div>
      </div>
      
      			
      <div class="layui-tab-content" style="padding:0;">
	    <div class="layui-tab-item layui-show">
	    	<table id="logTable" lay-filter="logTab"></table>
	    </div>
      </div>
    </div>
  </div>

<script src="$!{rc.contextPath}/static/res/layui/layui.js"></script>
<script src="$!{rc.contextPath}/static/js/util.js"></script>
<script>
//table
layui.use(['table','jquery','form'], function(){
	  var table = layui.table;
	  var $ = layui.$ , active = {
	    reload: function(){
	    	var username=$('#userNameInput').val()?$('#userNameInput').val():null;
	        //执行重载
	        table.reload('tab', {
	          page: {
	            curr: 1 //重新从第 1 页开始
	          }
	          ,where: {
	        	  operateType: $('#operateType').val(),
	        	  username:username
	          }
	        });
	      }
	    };
	  
	  $('#search').on('click', function(){
		   var type = $(this).data('type');
		   active[type] ? active[type].call(this) : '';
	  });
	  
	  //第一个实例
	  table.render({
		id: 'tab',  
	    method: 'post',  
	    elem: '#logTable',
	    height: 500,
	    request: {
	    	pageName: 'pageNo', //页码的参数名称，默认：page
	    	limitName: 'pageSize' //每页数据量的参数名，默认：limit
	    },
	    response: {
	        statusCode: 200, //成功的状态码，默认：0
	        countName: 'total', //数据总数的字段名称，默认：count
	        dataName: 'data' //数据列表的字段名称，默认：data
	    },
	    url: '$!{rc.contextPath}/user/operateLog/getPageData', //数据接口
	    page: true ,//开启分页
	    cols: [[ //表头
	      {type: 'numbers',title:'序号'},
	      {field: 'username', title: '用户名', width:100},
	      {field: 'operateTypeName', title: '操作类型', width:120},
	      {field: 'content', title: '操作内容', width:800},
	      {field: 'ipStr', title: 'ip地址', width:100},
	      {field: 'createTime', title: '操作时间', width:160}
	    ]]
	  });
});
</script>
#parse("./html/common/common.html")
</body>
</html>